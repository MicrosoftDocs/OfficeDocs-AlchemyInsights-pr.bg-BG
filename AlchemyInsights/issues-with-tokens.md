---
title: Проблеми с маркери
ms.author: v-smandalika
author: v-smandalika
manager: dansimp
ms.date: 01/15/2021
ms.audience: Admin
ms.topic: article
ms.service: o365-administration
ROBOTS: NOINDEX, NOFOLLOW
localization_priority: Priority
ms.collection: Adm_O365
ms.custom:
- "7774"
- "9004351"
ms.openlocfilehash: 14a9681c08920094813497e7a75eb87bb0733cbc
ms.sourcegitcommit: e378232f4c9ef4e962208100db752221e7bd2dd6
ms.translationtype: MT
ms.contentlocale: bg-BG
ms.lasthandoff: 01/20/2021
ms.locfileid: "49916693"
---
# <a name="issues-with-tokens"></a><span data-ttu-id="d1085-102">Проблеми с маркери</span><span class="sxs-lookup"><span data-stu-id="d1085-102">Issues with tokens</span></span>

<span data-ttu-id="d1085-103">За да управлявате проблемите, свързани с маркери, можете да изпълните следните стъпки:</span><span class="sxs-lookup"><span data-stu-id="d1085-103">To manage issues related to tokens, you can perform the following steps:</span></span>

1. <span data-ttu-id="d1085-104">Можете да укажете живота на маркер на Access, ИД или SAML, издаден от платформата за самоличност на Microsoft.</span><span class="sxs-lookup"><span data-stu-id="d1085-104">You can specify the lifetime of an access, ID, or SAML token issued by Microsoft identity platform.</span></span> <span data-ttu-id="d1085-105">Можете да зададете маркери за цял живот за всички приложения във вашата организация, за приложение за много клиенти (мултиорганизация) или за определен принципал на услуга във вашата организация.</span><span class="sxs-lookup"><span data-stu-id="d1085-105">You can set token lifetimes for all apps in your organization, for a multi-tenant (multi-organization) application, or for a specific service principal in your organization.</span></span> <span data-ttu-id="d1085-106">За повече информация вижте [конфигурируеми животи с маркери в Microsoft Identity Platform (предварителен преглед)](https://docs.microsoft.com/azure/active-directory/develop/active-directory-configurable-token-lifetimes).</span><span class="sxs-lookup"><span data-stu-id="d1085-106">For more information, see [Configurable token lifetimes in Microsoft identity platform (preview)](https://docs.microsoft.com/azure/active-directory/develop/active-directory-configurable-token-lifetimes).</span></span>
2. <span data-ttu-id="d1085-107">Маркерите на Access разрешават на клиентите безопасно да се обаждат на защитени уеб API и се използват от уеб API за извършване на удостоверяване и упълномощаване.</span><span class="sxs-lookup"><span data-stu-id="d1085-107">Access tokens enable clients to securely call protected web APIs, and are used by web APIs to perform authentication and authorization.</span></span> <span data-ttu-id="d1085-108">Както по спецификацията за OAuth, маркерите на Access са непрозрачни низове без зададен формат – някои доставчици на самоличност (Врл) използват GUID, други използват шифровани петна.</span><span class="sxs-lookup"><span data-stu-id="d1085-108">As per the OAuth specification, access tokens are opaque strings without a set format - some identity providers (IDPs) use GUIDs, others use encrypted blobs.</span></span> <span data-ttu-id="d1085-109">Платформата за самоличност на Microsoft използва различни формати за маркери на Access в зависимост от конфигурацията на API, който приема маркера.</span><span class="sxs-lookup"><span data-stu-id="d1085-109">The Microsoft identity platform uses a variety of access token formats, depending on the configuration of the API that accepts the token.</span></span> <span data-ttu-id="d1085-110">За да научите как Вашият API може да провери и да използва претенциите в маркер на Access, вижте [маркери за достъп до платформата за самоличност на Microsoft](https://docs.microsoft.com/azure/active-directory/develop/userinfo#calling-the-userinfo-endpoint).</span><span class="sxs-lookup"><span data-stu-id="d1085-110">To learn how your API can validate and use the claims inside an access token, see [Microsoft identity platform access tokens](https://docs.microsoft.com/azure/active-directory/develop/userinfo#calling-the-userinfo-endpoint).</span></span>
3. <span data-ttu-id="d1085-111">Библиотеката за удостоверяване на Microsoft (MSAL) поддържа няколко потока на удостоверяване за използване в различни сценарии за приложения.</span><span class="sxs-lookup"><span data-stu-id="d1085-111">The Microsoft Authentication Library (MSAL) supports several authentication flows for use in different application scenarios.</span></span> <span data-ttu-id="d1085-112">За повече информация вижте [потоци на удостоверяване](https://docs.microsoft.com/azure/active-directory/develop/msal-authentication-flows#how-each-flow-emits-tokens-and-codes).</span><span class="sxs-lookup"><span data-stu-id="d1085-112">For more information, see [Authentication flows](https://docs.microsoft.com/azure/active-directory/develop/msal-authentication-flows#how-each-flow-emits-tokens-and-codes).</span></span>
4. <span data-ttu-id="d1085-113">Помощта за разрешаване на OAuth 2,0 може да се използва в приложения, които са инсталирани на устройство, за да получат достъп до защитени ресурси, като например Web API.</span><span class="sxs-lookup"><span data-stu-id="d1085-113">The OAuth 2.0 authorization code grant can be used in apps that are installed on a device to gain access to protected resources, such as web APIs.</span></span> <span data-ttu-id="d1085-114">С помощта на платформата за самоличност на Microsoft за изпълнение на OAuth 2,0 можете да добавите влизане и достъп до API към вашите мобилни и настолни приложения.</span><span class="sxs-lookup"><span data-stu-id="d1085-114">Using the Microsoft identity platform implementation of OAuth 2.0, you can add sign-in and API access to your mobile and desktop apps.</span></span> <span data-ttu-id="d1085-115">Вижте [Microsoft Identity Platform и OAuth 2,0 за разрешаване на код](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-auth-code-flow#refresh-the-access-token) за програмата за как да програмирате директно спрямо Протокола във вашето приложение, като използвате произволен език.</span><span class="sxs-lookup"><span data-stu-id="d1085-115">See [Microsoft identity platform and OAuth 2.0 authorization code flow](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-auth-code-flow#refresh-the-access-token) for how to program directly against the protocol in your application, using any language.</span></span>
5. <span data-ttu-id="d1085-116">OpenID Connect (OIDC) е протокол за удостоверяване, изграден върху OAuth 2,0, който можете да използвате за защитено влизане на потребител в приложение.</span><span class="sxs-lookup"><span data-stu-id="d1085-116">OpenID Connect (OIDC) is an authentication protocol built on OAuth 2.0 that you can use to securely sign in a user to an application.</span></span> <span data-ttu-id="d1085-117">Когато използвате приложението за крайна точка на платформата за самоличност на Microsoft с OpenID Connect, можете да добавите влизане и достъп до API към приложенията си.</span><span class="sxs-lookup"><span data-stu-id="d1085-117">When you use the Microsoft identity platform endpoint's implementation of OpenID Connect, you can add sign-in and API access to your apps.</span></span> <span data-ttu-id="d1085-118">[Платформата за самоличност на Microsoft и Протоколът за OpenID свързване](https://docs.microsoft.com/azure/active-directory/develop/v2-protocols-oidc#send-the-sign-in-request) показва как да направите това независимо от езика и как да изпращате и получавате HTTP съобщения, без да използвате никоя библиотека с отворен код на Microsoft.</span><span class="sxs-lookup"><span data-stu-id="d1085-118">[Microsoft identity platform and OpenID Connect protocol](https://docs.microsoft.com/azure/active-directory/develop/v2-protocols-oidc#send-the-sign-in-request) shows how to do this independent of language and describes how to send and receive HTTP messages without using any Microsoft open-source libraries.</span></span>
    - <span data-ttu-id="d1085-119">Крайна точка UserInfo е част от OIDC стандарт, предназначени за връщане на рекламации за потребителя, който е удостоверен.</span><span class="sxs-lookup"><span data-stu-id="d1085-119">The UserInfo endpoint is part of the OIDC standard, designed to return claims about the user that authenticated.</span></span> <span data-ttu-id="d1085-120">За повече информация вижте [крайна точка за Microsoft Identity Platform UserInfo](https://docs.microsoft.com/azure/active-directory/develop/userinfo#consider-use-an-id-token-instead).</span><span class="sxs-lookup"><span data-stu-id="d1085-120">For more information, see [Microsoft identity platform UserInfo endpoint](https://docs.microsoft.com/azure/active-directory/develop/userinfo#consider-use-an-id-token-instead).</span></span>
    - <span data-ttu-id="d1085-121">[Обаждането на уеб API в уеб приложение чрез AZURE ad и OpenID Connect](https://docs.microsoft.com/samples/azure-samples/active-directory-dotnet-webapp-webapi-openidconnect/active-directory-dotnet-webapp-webapi-openidconnect/) пример показва как да създадете MVC уеб приложение, което използва Azure ad за влизане чрез протокола за OpenID Connect, а след това да се обадите на уеб API под самоличността на потребителя, който използва маркери, получени чрез OAuth 2,0.</span><span class="sxs-lookup"><span data-stu-id="d1085-121">The [Calling a web API in a web app using Azure AD and OpenID Connect](https://docs.microsoft.com/samples/azure-samples/active-directory-dotnet-webapp-webapi-openidconnect/active-directory-dotnet-webapp-webapi-openidconnect/) sample shows how to build an MVC web application that uses Azure AD for sign-in using the OpenID Connect protocol, and then call a web API under the signed-in user's identity using tokens obtained via OAuth 2.0.</span></span> <span data-ttu-id="d1085-122">Тази извадка използва приложението OpenID Connect ASP .net OWIN и ADAL .net.</span><span class="sxs-lookup"><span data-stu-id="d1085-122">This sample uses the OpenID Connect ASP .Net OWIN middleware and ADAL .Net.</span></span>
6. <span data-ttu-id="d1085-123">[Конфигуриране на приложение за изложите уеб API](https://docs.microsoft.com/azure/active-directory/develop/quickstart-configure-app-expose-web-apis) – в този бърз старт можете да регистрирате уеб API с платформата Microsoft Identity и да я излагате на клиентски приложения, като добавите примерен обхват.</span><span class="sxs-lookup"><span data-stu-id="d1085-123">[Configure an application to expose a web API](https://docs.microsoft.com/azure/active-directory/develop/quickstart-configure-app-expose-web-apis) - In this quickstart, you register a web API with the Microsoft identity platform and expose it to client apps by adding an example scope.</span></span> <span data-ttu-id="d1085-124">Чрез регистрирането на вашия уеб API и изпробването му през обхвати можете да предоставяте достъп на разрешения до ресурсите си за оторизирани потребители и клиентски приложения, които осъществяват достъп до вашия API.</span><span class="sxs-lookup"><span data-stu-id="d1085-124">By registering your web API and exposing it through scopes, you can provide permissions-based access to its resources to authorized users and client apps that access your API.</span></span>
7. <span data-ttu-id="d1085-125">В Azure Active Directory B2C (Azure AD B2C), Flow идентификационни данни за парола на собственик на ресурс (ROPC) е OAuth стандартния поток за удостоверяване.</span><span class="sxs-lookup"><span data-stu-id="d1085-125">In Azure Active Directory B2C (Azure AD B2C), the resource owner password credentials (ROPC) flow is an OAuth standard authentication flow.</span></span> <span data-ttu-id="d1085-126">В този поток приложение, което е известно като доверяващо се страна, обменя валидни идентификационни данни за жетони.</span><span class="sxs-lookup"><span data-stu-id="d1085-126">In this flow, an application, also known as the relying party, exchanges valid credentials for tokens.</span></span> <span data-ttu-id="d1085-127">Идентификационните данни включват потребителски ИД и парола.</span><span class="sxs-lookup"><span data-stu-id="d1085-127">The credentials include a user ID and password.</span></span> <span data-ttu-id="d1085-128">Върнатите маркери са ИД маркер, маркер за достъп и маркер за обновяване.</span><span class="sxs-lookup"><span data-stu-id="d1085-128">The tokens returned are an ID token, access token, and a refresh token.</span></span> <span data-ttu-id="d1085-129">За повече информация вижте [Настройване на удостоверяване на парола за собственик на ресурс в Azure Active DIRECTORY B2C](https://docs.microsoft.com/azure/active-directory-b2c/add-ropc-policy?tabs=app-reg-ga&pivots=b2c-user-flow).</span><span class="sxs-lookup"><span data-stu-id="d1085-129">For more information, see [Set up a resource owner password credentials flow in Azure Active Directory B2C](https://docs.microsoft.com/azure/active-directory-b2c/add-ropc-policy?tabs=app-reg-ga&pivots=b2c-user-flow).</span></span> 

